#:kivy 2.3.0

<RootManager>:
	splash: splash
	landing: landing
	signup: signup
	signin: signin
	home: home
	dashboard: dashboard
	survey: survey
	overall: overall
	progress: progress
	search: search
	action1: action1
	habit: habit
	connect: connect

	SplashScreen:
		id: splash
		name: "splash"
	LandingScreen:
		id: landing
		name: "landing"
	SignUpScreen:
		id: signup
		name: "signup"
	SignInScreen:
		id: signin
		name: "signin"
	HomeScreen:
		id: home
		name: "home"
	DashboardScreen:
		id: dashboard
		name: "dashboard"
	TakeSurveyScreen:
		id: survey
		name: "survey"
	OverallScreen:
		id: overall
		name: "overall"
	ProgressScreen:
		id: progress
		name: "progress"
	SearchScreen:
		id: search
		name: "search"
	ActionScreen:
		id: action1
		title: "Reduce Food Waste"
		name: "action1"
	HabitScreen:
		id: habit
		name: "habit"
	ConnectScreen:
		id: connect
		name: "connect"

<SplashScreen>:
	BoxLayout:
		orientation: "vertical"
		spacing: dp(10)
		padding: dp(24)
		Label:
			text: "Carbonfootprint"
			font_size: dp(28)
			bold: True
			valign: "middle"
			halign: "center"

<LandingScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(24)
		spacing: dp(12)
		Label:
			text: "Welcome"
			font_size: dp(24)
		Button:
			text: "Join (Organization)"
			on_release: app.switch_screen("signup")
		Button:
			text: "Join (Own)"
			on_release: app.switch_screen("signup")
		Widget:
			

<SignUpScreen>:
	first_name: first_name
	last_name: last_name
	email: email
	password: password
	confirm_password: confirm_password
	BoxLayout:
		orientation: "vertical"
		padding: dp(24)
		spacing: dp(10)
		Label:
			text: "Create Account"
			font_size: dp(22)
		TextInput:
			id: first_name
			hint_text: "First name"
		TextInput:
			id: last_name
			hint_text: "Last name"
		TextInput:
			id: email
			hint_text: "Email"
			input_type: "text"
		TextInput:
			id: password
			hint_text: "Password (min 8)"
			password: True
		TextInput:
			id: confirm_password
			hint_text: "Confirm password"
			password: True
		Button:
			text: "Create Account"
			on_release: root.handle_create_account()
		Label:
			text: root.status_text
			color: 1,0,0,1
		Button:
			text: "Already have an account? Sign in"
			size_hint_y: None
			height: dp(40)
			on_release: app.switch_screen("signin")

<SignInScreen>:
	signin_email: signin_email
	signin_password: signin_password
	BoxLayout:
		orientation: "vertical"
		padding: dp(24)
		spacing: dp(10)
		Label:
			text: "Sign In"
			font_size: dp(22)
		TextInput:
			id: signin_email
			hint_text: "Email"
		TextInput:
			id: signin_password
			hint_text: "Password (min 8)"
			password: True
		Button:
			text: "Sign In"
			on_release: root.handle_login()
		Label:
			text: root.status_text
			color: 1,0,0,1

<ClickableCard@ButtonBehavior+BoxLayout>:
	orientation: "vertical"
	size_hint_y: None
	height: dp(230)
	size_hint_x: None
	width: dp(350)
	padding: 0, 0
	canvas.before:
		Color:
			rgba: 1,1,1,1
		RoundedRectangle:
			pos: self.pos
			size: self.size
			radius: [20, 20, 20, 20]

<ClickableRow@ButtonBehavior+BoxLayout>:
	size_hint_y: None
	height: dp(53)
	padding: dp(10), 0
	spacing: dp(10)
	canvas.before:
		Color:
			rgba: 1,1,1,1
		RoundedRectangle:
			pos: self.pos
			size: self.size
			radius: [15, 15, 15, 15]

<ClickableImage@ButtonBehavior+Image>:
	allow_stretch: True
	keep_ratio: True
	size_hint: None, None
	size: dp(43), dp(43)

<HomeScreen>:
	BoxLayout:
		orientation: "vertical"
		spacing: 0
		# HEADER
		BoxLayout:
			id: header
			size_hint_y: None
			height: dp(107)
			padding: dp(30), 0, dp(30), 0
			spacing: dp(10)
			# Left: innerLinearLayout clickable pill
			ClickableRow:
				id: innerLinearLayout
				size_hint_x: 0.7
				on_release: root.open_survey_or_overall()
				Image:
					source: "/workspace/app/src/main/res/drawable/foxh.png"
					size_hint_x: None
					width: dp(24)
				Label:
					text: "Calculate Your Footprint"
					color: 0,0,0,1
					font_size: dp(14)
				Image:
					source: "/workspace/app/src/main/res/drawable/backarrow.png"
					size_hint_x: None
					width: dp(24)
			# Right: user icon button
			Widget:
				size_hint_x: 0.1
			ClickableImage:
				id: userImage2
				source: "/workspace/app/src/main/res/drawable/user.png"
				on_release: app.switch_screen("dashboard")

		# CONTENT
		ScrollView:
			do_scroll_y: True
			do_scroll_x: False
			bar_width: 0
			BoxLayout:
				orientation: "vertical"
				size_hint_y: None
				height: self.minimum_height
				padding: dp(0), dp(157), dp(0), dp(70)
				spacing: dp(20)
				Label:
					text: "It’s your chance to\n take action, User."
					color: 0.105, 0.262, 0.196, 1
					font_size: dp(32)
					size_hint_y: None
					height: self.texture_size[1]
					halign: "left"
					valign: "top"
					text_size: self.width, None
				Label:
					text: "Recommended actions"
					color: 0.105, 0.262, 0.196, 1
					font_size: dp(13)
					size_hint_y: None
					height: self.texture_size[1]
					text_size: self.width, None
					padding: dp(60), 0
				# Horizontal cards
				ScrollView:
					size_hint_y: None
					height: dp(260)
					do_scroll_x: True
					do_scroll_y: False
					bar_width: 0
					BoxLayout:
						orientation: "horizontal"
						size_hint_x: None
						width: self.minimum_width
						height: dp(230)
						padding: dp(60), 0
						spacing: dp(120)
						# Card 1
						ClickableCard:
							id: card1
							on_release: app.switch_screen("action1")
							BoxLayout:
								orientation: "horizontal"
								# Left half
								BoxLayout:
									orientation: "vertical"
									size_hint_x: 0.5
									padding: dp(20), dp(30), dp(0), dp(0)
									spacing: dp(10)
									Label:
										text: "Reduce food waste"
										color: 0,0,0,1
										font_size: dp(16)
									Label:
										text: "Saving leftovers or planning\nmeals can reduce waste and save\nup to 500g of CO₂ per day."
										color: 0,0,0,1
										font_size: dp(10)
									BoxLayout:
										orientation: "horizontal"
										spacing: dp(10)
										BoxLayout:
											size_hint: None, None
											size: dp(48), dp(24)
											padding: dp(6), dp(2)
											canvas.before:
												Color:
													rgba: 1,1,1,1
												RoundedRectangle:
													pos: self.pos
													size: self.size
													radius: [12,12,12,12]
											Image:
												source: "/workspace/app/src/main/res/drawable/shadowv1.png"
												allow_stretch: True
												keep_ratio: True
											Label:
												text: "400g"
												font_size: dp(10)
												color: 0,0,0,1
										BoxLayout:
											size_hint: None, None
											size: dp(48), dp(24)
											padding: dp(6), dp(2)
											canvas.before:
												Color:
													rgba: 1,1,1,1
												RoundedRectangle:
													pos: self.pos
													size: self.size
													radius: [12,12,12,12]
											Image:
												source: "/workspace/app/src/main/res/drawable/shadowv2.png"
												allow_stretch: True
												keep_ratio: True
											Label:
												text: "+25"
												font_size: dp(10)
												color: 0,0,0,1
									BoxLayout:
										orientation: "horizontal"
										padding: dp(20), 0
										spacing: dp(15)
										Image:
											source: "/workspace/app/src/main/res/drawable/meal1.png"
											allow_stretch: True
											keep_ratio: True
										Image:
											source: "/workspace/app/src/main/res/drawable/beverage2.png"
											allow_stretch: True
											keep_ratio: True
								# Right half
								BoxLayout:
									size_hint_x: 0.5
									padding: 0, dp(30), 0, 0
									Image:
										source: "/workspace/app/src/main/res/drawable/meal1.png"
										allow_stretch: True
										keep_ratio: True
						# Card 2
						ClickableCard:
							id: Card2
							on_release: app.switch_screen("action1")
							BoxLayout:
								orientation: "horizontal"
								# Left
								BoxLayout:
									orientation: "vertical"
									size_hint_x: 0.6
									padding: dp(20), dp(30), dp(0), dp(0)
									spacing: dp(10)
									Label:
										text: "Walk for short distances"
										color: 0,0,0,1
										font_size: dp(16)
									Label:
										text: "Choosing to walk instead of drive\nfor under 3km can save ~0.4kg of CO₂ per trip."
										color: 0,0,0,1
										font_size: dp(10)
									BoxLayout:
										orientation: "horizontal"
										spacing: dp(10)
										BoxLayout:
											size_hint: None, None
											size: dp(48), dp(24)
											padding: dp(6), dp(2)
											canvas.before:
												Color:
													rgba: 1,1,1,1
												RoundedRectangle:
													pos: self.pos
													size: self.size
													radius: [12,12,12,12]
											Image:
												source: "/workspace/app/src/main/res/drawable/shadowv1.png"
												allow_stretch: True
												keep_ratio: True
											Label:
												text: "400g"
												font_size: dp(10)
												color: 0,0,0,1
										BoxLayout:
											size_hint: None, None
											size: dp(48), dp(24)
											padding: dp(6), dp(2)
											canvas.before:
												Color:
													rgba: 1,1,1,1
												RoundedRectangle:
													pos: self.pos
													size: self.size
													radius: [12,12,12,12]
											Image:
												source: "/workspace/app/src/main/res/drawable/shadowv2.png"
												allow_stretch: True
												keep_ratio: True
											Label:
												text: "+5"
												font_size: dp(10)
												color: 0,0,0,1
								# Right
								BoxLayout:
									size_hint_x: 0.4
									padding: 0, dp(30), 0, 0
									Image:
										source: "/workspace/app/src/main/res/drawable/walk.png"
										allow_stretch: True
										keep_ratio: True

		# FOOTER
		BoxLayout:
			size_hint_y: None
			height: dp(77)
			padding: dp(24), 0
			spacing: dp(24)
			canvas.before:
				Color:
					rgba: 0.95, 0.96, 0.99, 1
				Rectangle:
					pos: self.pos
					size: self.size
			# home
			BoxLayout:
				size_hint: None, None
				size: dp(43), dp(43)
				canvas.before:
					Color:
						rgba: 1,1,1,1
					RoundedRectangle:
						pos: self.pos
						size: self.size
						radius: [21,21,21,21]
				Image:
					source: "/workspace/app/src/main/res/drawable/fox.png"
					size_hint: None, None
					size: dp(43), dp(43)
			# search
			ClickableImage:
				id: hehe
				source: "/workspace/app/src/main/res/drawable/search.png"
				on_release: app.switch_screen("search")
			# progress
			ClickableImage:
				id: progress
				source: "/workspace/app/src/main/res/drawable/progress.png"
				on_release: app.switch_screen("progress")
			# connect
			ClickableImage:
				id: connect
				source: "/workspace/app/src/main/res/drawable/group.png"
				on_release: app.switch_screen("connect")
			# reward (no action)
			BoxLayout:
				size_hint: None, None
				size: dp(43), dp(43)
				canvas.before:
					Color:
						rgba: 1,1,1,1
					RoundedRectangle:
						pos: self.pos
						size: self.size
						radius: [21,21,21,21]
				Image:
					source: "/workspace/app/src/main/res/drawable/reward.png"
					size_hint: None, None
					size: dp(43), dp(43)
<DashboardScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		BoxLayout:
			size_hint_y: None
			height: dp(40)
			Label:
				text: root.user_name
				bold: True
				font_size: dp(18)
			Label:
				text: root.month_year
		Label:
			text: root.co2_saved_text
		Label:
			text: "Tali Points: " + root.tali_points_text
		BoxLayout:
			size_hint_y: None
			height: dp(220)
			spacing: dp(10)
			canvas.before:
				Color:
					rgba: 0.95,0.95,0.95,1
				Rectangle:
					pos: self.pos
					size: self.size
			BoxLayout:
				orientation: "vertical"
				Label:
					text: "Home"
					font_size: dp(12)
				Widget:
					id: home_bar
					size_hint_y: None
					height: dp(10)
			BoxLayout:
				orientation: "vertical"
				Label:
					text: "Travel"
					font_size: dp(12)
				Widget:
					id: travel_bar
					size_hint_y: None
					height: dp(10)
			BoxLayout:
				orientation: "vertical"
				Label:
					text: "Food"
					font_size: dp(12)
				Widget:
					id: food_bar
					size_hint_y: None
					height: dp(10)
			BoxLayout:
				orientation: "vertical"
				Label:
					text: "Others"
					font_size: dp(12)
				Widget:
					id: others_bar
					size_hint_y: None
					height: dp(10)
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<TakeSurveyScreen>:
	home_input: home_input
	travel_input: travel_input
	food_input: food_input
	others_input: others_input
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Enter annual emissions (tons)"
			font_size: dp(18)
		GridLayout:
			cols: 2
			row_default_height: dp(48)
			row_force_default: True
			spacing: dp(6)
			Label:
				text: "Home"
			TextInput:
				id: home_input
				text: "0.0"
			Label:
				text: "Travel"
			TextInput:
				id: travel_input
				text: "0.0"
			Label:
				text: "Food"
			TextInput:
				id: food_input
				text: "0.0"
			Label:
				text: "Others"
			TextInput:
				id: others_input
				text: "0.0"
		Button:
			text: "Save Survey"
			size_hint_y: None
			height: dp(44)
			on_release: root.save_survey()
		Label:
			text: root.status_text
			color: 1,0,0,1
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<OverallScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Overall"
			font_size: dp(22)
		Label:
			text: root.total_text
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<ProgressScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Progress"
			font_size: dp(22)
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<SearchScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Search"
			font_size: dp(22)
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<ActionScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: root.title
			font_size: dp(22)
		Label:
			text: "Complete this action to earn points."
		Button:
			text: "Mark as Done"
			on_release: root.complete_action()
		Label:
			text: "Completed!" if root.completed else ""
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<HabitScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Habit"
			font_size: dp(22)
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")

<ConnectScreen>:
	BoxLayout:
		orientation: "vertical"
		padding: dp(16)
		spacing: dp(8)
		Label:
			text: "Connect"
			font_size: dp(22)
		Button:
			text: "Back"
			size_hint_y: None
			height: dp(44)
			on_release: app.switch_screen("home")